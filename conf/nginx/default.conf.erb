worker_processes 4;
daemon off;

events {
    worker_connections  1024;
}

http {
    sendfile    on;
    tcp_nopush  on;

    keepalive_timeout  65;

    error_log logs/error.log notice;
    access_log logs/access.log;

    index <%= ENV['INDEX_DOCUMENT'] %> index.html index.htm index.xhtml;

    <% if ENV['FRAMEWORK'].length > 0 %>
    include <%= ENV['FRAMEWORK'] %>.conf;
    <% else %>
    # Default configuration for non-framework apps
    server {
        server_name localhost;
        listen <%= ENV['PORT'] %>;
        root <%= ENV['DOCUMENT_ROOT'] %>;

        location ~ \.php {
            include fastcgi_params;
            fastcgi_param  SCRIPT_FILENAME    $document_root$fastcgi_script_name;
            fastcgi_pass unix:/tmp/php-fpm.sock;
        }
    }
    <% end %>
}
