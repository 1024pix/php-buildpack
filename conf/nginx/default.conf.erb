worker_processes 4;
daemon off;

events {
    worker_connections  1024;
}

http {
    upstream phpfpm {
        server unix:/tmp/php-fpm.sock;
    }

    sendfile    on;
    tcp_nopush  on;

    keepalive_timeout  65;
     
    error_log logs/error.log notice;
    access_log logs/access.log;

    server {
        listen <%= ENV['PORT'] %>;
     
        server_name localhost;
        root <%= ENV['DOCUMENT_ROOT'] %>;
     
        index  index.html index.htm index.xhtml index.php;
        try_files $uri $uri/ index.php;

        location ~ \.php {
            include         fastcgi.conf;
            fastcgi_pass    unix:/tmp/php-fpm.sck;
        }
    }
}
